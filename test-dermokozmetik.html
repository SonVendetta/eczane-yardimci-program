<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dermokozmetik AI Test - Eczane YardÄ±mcÄ±</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .test-card { background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .result-box { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin: 10px 0; }
        .success { color: #198754; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #0dcaf0; }
        .gradient-info { background: linear-gradient(45deg, #17a2b8, #20c997); }
        .gradient-success { background: linear-gradient(45deg, #28a745, #20c997); }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <div class="test-card p-4">
                    <h3 class="text-center mb-4">
                        <i class="fas fa-spa text-primary"></i>
                        Dermokozmetik AI Test SayfasÄ±
                    </h3>
                    
                    <div class="mb-4">
                        <h5>Test Durumu</h5>
                        <div id="testStatus" class="result-box">
                            <i class="fas fa-spinner fa-spin"></i> Test baÅŸlatÄ±lÄ±yor...
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h5>API Key Durumu</h5>
                        <div id="apiKeyStatus" class="result-box">
                            Kontrol ediliyor...
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h5>Dermokozmetik AI Testi</h5>
                        <div class="mb-3">
                            <label class="form-label">Test Dermokozmetik SemptomlarÄ±:</label>
                            <textarea class="form-control" id="testDermokozmetikSymptoms" rows="3" 
                                      placeholder="Ã–rnek: Cilt kuruluÄŸu var, kÄ±rÄ±ÅŸÄ±klar var, yaÅŸlanma iÅŸaretleri var...">cilt kuruluÄŸu ve kÄ±rÄ±ÅŸÄ±klar</textarea>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label">YaÅŸ:</label>
                                <input type="number" class="form-control" id="testAge" value="35" min="1" max="120">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Cinsiyet:</label>
                                <select class="form-select" id="testGender">
                                    <option value="kadin">KadÄ±n</option>
                                    <option value="erkek">Erkek</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Kilo:</label>
                                <input type="number" class="form-control" id="testWeight" value="65" min="20" max="200">
                            </div>
                        </div>
                        <button id="testDermokozmetikAnalysis" class="btn btn-primary">
                            <i class="fas fa-spa"></i> Dermokozmetik AI Analiz Testi
                        </button>
                        <div id="dermokozmetikAnalysisResult" class="result-box mt-3" style="display: none;">
                            Analiz sonucu burada gÃ¶rÃ¼necek...
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h5>Hata AyÄ±klama</h5>
                        <div id="debugInfo" class="result-box">
                            <small>Hata ayÄ±klama bilgileri burada gÃ¶rÃ¼necek...</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="gemini-config.js"></script>
    <script>
        // Test fonksiyonlarÄ±
        async function runTests() {
            updateStatus('testStatus', 'Testler baÅŸlatÄ±lÄ±yor...', 'info');
            
            // API Key kontrolÃ¼
            await checkApiKey();
            
            updateStatus('testStatus', 'TÃ¼m testler tamamlandÄ±!', 'success');
        }
        
        async function checkApiKey() {
            try {
                if (window.geminiAI && window.geminiAI.getApiKey()) {
                    const apiKey = window.geminiAI.getApiKey();
                    const maskedKey = apiKey.substring(0, 10) + '...' + apiKey.substring(apiKey.length - 4);
                    updateStatus('apiKeyStatus', `âœ… API Key ayarlÄ±: ${maskedKey}`, 'success');
                } else {
                    updateStatus('apiKeyStatus', 'âŒ API Key ayarlanmamÄ±ÅŸ', 'error');
                }
            } catch (error) {
                updateStatus('apiKeyStatus', `âŒ API Key hatasÄ±: ${error.message}`, 'error');
            }
        }
        
        async function testDermokozmetikAnalysis() {
            const symptoms = document.getElementById('testDermokozmetikSymptoms').value.trim();
            const age = document.getElementById('testAge').value;
            const gender = document.getElementById('testGender').value;
            const weight = document.getElementById('testWeight').value;
            const resultDiv = document.getElementById('dermokozmetikAnalysisResult');
            
            if (!symptoms) {
                alert('LÃ¼tfen dermokozmetik semptomlarÄ± girin!');
                return;
            }
            
            try {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Dermokozmetik AI analizi yapÄ±lÄ±yor...';
                
                if (!window.geminiAI || !window.geminiAI.isConfigured) {
                    resultDiv.innerHTML = '<div class="error">âŒ Gemini AI ayarlanmamÄ±ÅŸ</div>';
                    return;
                }
                
                // Test verileri
                const testIndications = {
                    "Temizlik ÃœrÃ¼nleri": {
                        "AÃ§Ä±klama": "Cilt temizliÄŸi iÃ§in dermokozmetik Ã¼rÃ¼nler",
                        "ÃœrÃ¼nler": {
                            "YÃ¼z Temizleyici": {
                                "Dozlama": "GÃ¼nde 2 kez",
                                "KullanÄ±m Åekli": "Sabah ve akÅŸam yÃ¼z temizliÄŸi",
                                "Kontrendikasyonlar": "Hassas ciltlerde dikkatli kullanÄ±n"
                            }
                        }
                    },
                    "Nemlendiriciler": {
                        "AÃ§Ä±klama": "Cilt nemlendirme ve bakÄ±m Ã¼rÃ¼nleri",
                        "ÃœrÃ¼nler": {
                            "Nemlendirici Krem": {
                                "Dozlama": "GÃ¼nde 2 kez",
                                "KullanÄ±m Åekli": "Temizlik sonrasÄ± yÃ¼z ve boyun",
                                "Kontrendikasyonlar": "Aktif akne durumunda dikkatli kullanÄ±n"
                            },
                            "Hyaluronik Asit Serum": {
                                "Dozlama": "GÃ¼nde 1-2 kez",
                                "KullanÄ±m Åekli": "Temizlik sonrasÄ±, nemlendirici Ã¶ncesi",
                                "Kontrendikasyonlar": "AÃ§Ä±k yaralarda kullanmayÄ±n"
                            }
                        }
                    },
                    "Anti-Aging ÃœrÃ¼nler": {
                        "AÃ§Ä±klama": "YaÅŸlanma karÅŸÄ±tÄ± dermokozmetik Ã¼rÃ¼nler",
                        "ÃœrÃ¼nler": {
                            "Retinol Krem": {
                                "Dozlama": "Gece gÃ¼nde 1 kez",
                                "KullanÄ±m Åekli": "Temizlik sonrasÄ±, nemlendirici Ã¶ncesi",
                                "Kontrendikasyonlar": "Hamilelik, gÃ¼neÅŸ hassasiyeti"
                            }
                        }
                    }
                };
                
                const analysis = await window.geminiAI.analyzeDermokozmetik(
                    symptoms, 
                    age, 
                    gender, 
                    weight, 
                    testIndications
                );
                
                console.log('Dermokozmetik AI Analiz Sonucu:', analysis);
                
                // Sonucu gÃ¶ster
                let resultHtml = '<div class="success"><h6>âœ… Dermokozmetik AI Analiz BaÅŸarÄ±lÄ±!</h6></div>';
                resultHtml += `<div class="mt-3"><strong>Analiz:</strong> ${analysis.analysis || 'Analiz yapÄ±ldÄ±'}</div>`;
                resultHtml += `<div class="mt-2"><strong>GÃ¼ven Skoru:</strong> %${analysis.confidence || 'N/A'}</div>`;
                
                if (analysis.detected_symptoms && analysis.detected_symptoms.length > 0) {
                    resultHtml += `<div class="mt-2"><strong>Tespit Edilen Sorunlar:</strong> ${analysis.detected_symptoms.join(', ')}</div>`;
                }
                
                if (analysis.recommendations && analysis.recommendations.length > 0) {
                    resultHtml += '<div class="mt-3"><strong>Dermokozmetik Ã–neriler:</strong></div>';
                    analysis.recommendations.forEach(rec => {
                        resultHtml += `<div class="mt-2">â€¢ ${rec.symptom}: ${rec.description}</div>`;
                        if (rec.products && rec.products.length > 0) {
                            rec.products.forEach(product => {
                                resultHtml += `<div class="mt-1 ms-3">- ${product.name}: ${product.dosage}</div>`;
                            });
                        }
                    });
                }
                
                if (analysis.warnings && analysis.warnings.length > 0) {
                    resultHtml += '<div class="mt-3"><strong>UyarÄ±lar:</strong></div>';
                    analysis.warnings.forEach(warning => {
                        resultHtml += `<div class="mt-1 text-warning">â€¢ ${warning}</div>`;
                    });
                }
                
                resultDiv.innerHTML = resultHtml;
                
            } catch (error) {
                console.error('Dermokozmetik AI Analiz HatasÄ±:', error);
                resultDiv.innerHTML = `<div class="error">âŒ Dermokozmetik AI Analiz HatasÄ±: ${error.message}</div>`;
            }
        }
        
        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            const icon = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'ğŸ”„';
            element.innerHTML = `${icon} ${message}`;
            element.className = `result-box ${type}`;
        }
        
        function updateDebugInfo() {
            const debugDiv = document.getElementById('debugInfo');
            let debugInfo = '<strong>Hata AyÄ±klama Bilgileri:</strong><br>';
            
            debugInfo += `â€¢ Gemini AI YÃ¼klÃ¼: ${window.geminiAI ? 'Evet' : 'HayÄ±r'}<br>`;
            if (window.geminiAI) {
                debugInfo += `â€¢ API Key AyarlÄ±: ${window.geminiAI.isConfigured ? 'Evet' : 'HayÄ±r'}<br>`;
                debugInfo += `â€¢ analyzeDermokozmetik Fonksiyonu: ${typeof window.geminiAI.analyzeDermokozmetik === 'function' ? 'Mevcut' : 'Eksik'}<br>`;
            }
            debugInfo += `â€¢ TarayÄ±cÄ±: ${navigator.userAgent}<br>`;
            debugInfo += `â€¢ Zaman: ${new Date().toLocaleString('tr-TR')}`;
            
            debugDiv.innerHTML = debugInfo;
        }
        
        // Event listeners
        document.getElementById('testDermokozmetikAnalysis').addEventListener('click', testDermokozmetikAnalysis);
        
        // Sayfa yÃ¼klendiÄŸinde testleri baÅŸlat
        window.addEventListener('load', async () => {
            updateDebugInfo();
            await runTests();
        });
    </script>
</body>
</html> 